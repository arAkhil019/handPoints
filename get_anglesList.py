import numpy as np
import plot_cords as pc

#gives angle w.r.t the x axis
def get_angle(a,b,c):
    radians = np.arctan2(c[1]-b[1],c[0]-b[0]) - np.arctan2(a[1]-b[1],a[0]-b[0])
    angle = np.abs(np.degrees(radians))
    return angle

#to get angle between two lines points
def find_angle(p1, p2, p3):
    # Calculate the slopes of the lines
    m1 = (p2[1] - p1[1]) / (p2[0] - p1[0])
    m2 = (p3[1] - p1[1]) / (p3[0] - p1[0])

    # Calculate the angle between the lines
    angle = np.abs(np.degrees(np.arctan((m2 - m1) / (1 + m1 * m2))))
    return angle

def get_anglesList(landmarks):
    lm = landmarks
    angles = {}
    for i in range(1,21,4):
        a1 = find_angle(lm[i],lm[i+1],lm[i+2])
        a2 = find_angle(lm[i+1],lm[i+2],lm[i+3])
        angles[i+1] = a1
        angles[i+2] = a2
    return angles

# print(get_angle((0,0),(1,1),(2,2))) used to test the get_angle function, was correct.
landmarks = [(0.3918011486530304, 0.8184689879417419, 3.885636488121236e-07), (0.43526801466941833, 0.7857915163040161, -0.03076496161520481), (0.45651715993881226, 0.6857698559761047, -0.03671840578317642), (0.4408324360847473, 0.5911962389945984, -0.04046129062771797), (0.41809380054473877, 0.5208394527435303, -0.04346301034092903), (0.48219630122184753, 0.59078449010849, 0.0019855813588947058), (0.5012534856796265, 0.4927218556404114, 0.0026841775979846716), (0.5142167806625366, 0.4257718324661255, 0.0007124877301976085), (0.5238659381866455, 0.3737376928329468, -0.003195668337866664), (0.4497750401496887, 0.5750798583030701, 0.005244034808129072), (0.45917779207229614, 0.45588600635528564, 0.005241789855062962), (0.4671698808670044, 0.38452088832855225, -0.003012394765391946), (0.47044461965560913, 0.32182714343070984, -0.009596739895641804), (0.416007936000824, 0.5849811434745789, 0.003197520039975643), (0.413338303565979, 0.492110013961792, -0.0209416002035141), (0.41243505477905273, 0.5345792770385742, -0.042369186878204346), (0.4092143774032593, 0.5660463571548462, -0.05050204321742058), (0.3854701817035675, 0.6119505167007446, -0.0005653455154970288), (0.38772881031036377, 0.5572518706321716, -0.03152942284941673), (0.38970085978507996, 0.6041803956031799, -0.04854777455329895), (0.39083608984947205, 0.6491822004318237, -0.056185800582170486)]
print(get_anglesList(landmarks))
pc.plotter(landmarks,get_anglesList(landmarks))